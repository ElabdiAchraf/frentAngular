<div class="grid">
    <div class="col-12">
        <div class="card">
            <h5>For sale</h5>
            <p-dataView
                #dv
                [value]="Immobiliers"
                [paginator]="true"
                [rows]="9"
                filterBy="name"
                [sortField]="sortField"
                layout="grid"
            >
                <ng-template let-immo pTemplate="gridItem">
                    <div
                        *ngIf="immo.status == 'APPROVED'"
                        class="col-12 md:col-4"
                    >
                        <div class="card m-3 border-1 surface-border">
                            <div
                                class="flex align-items-center justify-content-between"
                            >
                                <div class="flex align-items-center">
                                    <i class="pi pi-tag mr-2"></i>
                                    <span class="font-semibold">{{
                                        immo.category
                                    }}</span>
                                </div>
                                <button
                                    type="button"
                                    pButton
                                    label="Details"
                                    (click)="showDetails(immo.id)"
                                    class="p-button-success"
                                ></button>
                                <span
                                    ><i class="pi pi-map-marker mr-2"></i
                                    >{{ immo.localisation }}</span
                                >
                            </div>
                            <div
                                class="text-center my-3"
                                *ngIf="immo.photos.length == 0"
                            >
                                <img
                                    src="../assets/Images/noImage.jpg"
                                    style="width: 264px"
                                    [preview]="true"
                                />
                            </div>
                            <div
                                *ngIf="immo.photos.length != 0"
                                class="text-center my-3"
                            >
                                <p-carousel
                                    [value]="immo.photos"
                                    [numVisible]="1"
                                    [numScroll]="1"
                                    [circular]="false"
                                    [responsiveOptions]="
                                        carouselResponsiveOptions
                                    "
                                >
                                    <ng-template pTemplate="item" let-item>
                                        <img
                                            [src]="
                                                '../assets/Images/' + item.path
                                            "
                                            style="width: 264px"
                                            [preview]="true"
                                        />
                                    </ng-template>
                                </p-carousel>

                                <div class="text-2xl font-bold">
                                    <small>{{ immo.description }} </small>
                                </div>
                            </div>
                            <div
                                class="flex align-items-center justify-content-between"
                            >
                                <span class="text-2xl font-semibold"
                                    >{{ immo.price }} ETH</span
                                >
                                <!-- <button
                                    pButton
                                    pRipple
                                    label="Details"
                                    class="p-button p-button-secondary"
                                    icon="pi pi-bookmark"
                                    (click)="showDetails(immo.id)"
                                ></button> -->
                                <button
                                    pButton
                                    pRipple
                                    label="Buy"
                                    class="p-button p-button-secondary"
                                    icon="pi pi-shopping-cart "
                                    (click)="
                                        displayBuyModel(
                                            immo.id,
                                            immo.ownerAddress,
                                            immo.price
                                        )
                                    "
                                ></button>
                                <p-button
                                    label="Order"
                                    icon="pi pi-bookmark"
                                    (click)="Order(immo.id)"
                                ></p-button>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </p-dataView>
        </div>
    </div>
</div>
<!-- <p-dialog
    [(visible)]="details"
    header="Immobilier details"
    [modal]="true"
    class="p-fluid w-900 md:w-200"
>
    <p-galleria
        [value]="images"
        [responsiveOptions]="galleriaResponsiveOptions"
        [containerStyle]="{ 'max-width': '800px', margin: 'auto' }"
        [numVisible]="6"
        [circular]="true"
    >
        <ng-template pTemplate="item" let-item>
            <p-image
                [src]="item.itemImageSrc"
                style="width: auto; display: block"
                [preview]="true"
            ></p-image>
        </ng-template>
        <ng-template pTemplate="thumbnail" let-item>
            <div class="grid nogutter justify-center">
                <img [src]="item.thumbnailImageSrc" style="display: block" />
            </div>
        </ng-template>
    </p-galleria>
    <div *ngIf="immobilierdetail">
        <div>
            <h3>Category</h3>
            <h4>{{ immobilierdetail.category }}</h4>
        </div>
        <div>
            <h3>Description</h3>
            <h4>{{ immobilierdetail.description }}</h4>
        </div>
        <div>
            <h3>Owner Address</h3>
            <h4>{{ immobilierdetail.ownerAddress }}</h4>
        </div>
        <div>
            <h3>Owner Name</h3>
            <h4>{{ immobilierdetail.ownerName }}</h4>
        </div>
        <div>
            <h3>Price</h3>
            <h4>{{ immobilierdetail.price }}</h4>
        </div>
        <div>
            <h3>Localisation</h3>
            <h4>{{ immobilierdetail.localisation }}</h4>
        </div>
        <div>
            <h3>Creation date</h3>
            <h4>{{ immobilierdetail.creation_date }}</h4>
        </div>
    </div>
</p-dialog> -->

<p-dialog
    [(visible)]="order"
    [style]="{ width: '450px' }"
    header="Order Immobilier"
    [modal]="true"
    class="p-fluid"
>
    <form role="form" [formGroup]="form" (submit)="OrderImmobilier()">
        <div class="field">
            <label for="buyerAddress">Your account Address </label>
            <input
                id="buyerAddress"
                formControlName="buyerAddress"
                pInputText
                required
            />
        </div>
        <div class="field">
            <label for="price">Your price</label>
            <input id="price" formControlName="price" pInputText required />
        </div>
        <div class="row">
            <div class="col-6">
                <button
                    pButton
                    pRipple
                    label="Order"
                    icon="pi pi-shopping-cart"
                    class="p-button-text"
                    type="submit"
                ></button>
            </div>
        </div>
    </form>
</p-dialog>
<p-dialog
    [(visible)]="buy"
    [style]="{ width: '450px' }"
    header="Buy Immobilier"
    [modal]="true"
    class="p-fluid"
>
    <form role="form" [formGroup]="Buyform" (submit)="BuyImmobilier()">
        <div class="field">
            <label for="_newOwner">Your account Address </label>
            <input
                id="_newOwner"
                formControlName="_newOwner"
                pInputText
                required
            />
        </div>
        <div class="field">
            <label for="privateKey">Your Private key</label>
            <input
                id="privateKey"
                formControlName="privateKey"
                pInputText
                required
            />
        </div>
        <div class="row">
            <div class="col-6">
                <button
                    pButton
                    pRipple
                    label="Buy"
                    icon="pi pi-shopping-cart"
                    class="p-button-text"
                    type="submit"
                ></button>
            </div>
        </div>
    </form>
</p-dialog>
<p-dialog
    *ngIf="details"
    [(visible)]="details"
    [style]="{ width: '450px' }"
    header="Immobilier details"
    [modal]="true"
    class="p-fluid"
>
    <ul>
        <li class="flex align-items-center py-3 px-2 surface-border flex-wrap">
            <div class="text-500 w-6 md:w-2 font-medium">Created at</div>
            <div class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1">
                {{ immobilierdetail.creation_date }}
            </div>
        </li>
        <li class="flex align-items-center py-3 px-2 surface-border flex-wrap">
            <div class="text-500 w-6 md:w-2 font-medium">Owner</div>
            <div class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1">
                {{ immobilierdetail.ownerAddress }}
            </div>
        </li>
        <li class="flex align-items-center py-3 px-2 surface-border flex-wrap">
            <div class="text-500 w-6 md:w-2 font-medium">Description</div>
            <div class="text-900 w-full md:w-8 md:flex-order-0 flex-order-1">
                {{ immobilierdetail.description }}
            </div>
        </li>
    </ul>
</p-dialog>
